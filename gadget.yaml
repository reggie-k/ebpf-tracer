name: 'file-io-tracer'
description: 'Trace open/close/exit and correlate fd to path to debug leftover lock files'
tracers:
  file_io_tracer:
    mapName: events
    structName: event
structs:
  event:
    fields:
    - name: timestamp
      description: Timestamp
      attributes:
        template: timestamp
    - name: pid
      description: Process ID
      attributes:
        template: pid
    - name: ppid
      description: Parent process ID
      attributes:
        template: pid
    - name: comm
      description: Process name
      attributes:
        template: comm
        length: 16
    - name: mntns_id
      description: Mount namespace ID
      attributes:
        template: ns
    - name: op
      description: Operation (open|close|exit)
      attributes:
        template: string
        length: 8
    - name: fd
      description: File descriptor
      attributes:
        template: int
    - name: retval
      description: Return value
      attributes:
        template: int
    - name: path
      description: File path
      attributes:
        template: string
        length: 256
    - name: argv
      description: Exec arguments (best-effort, limited)
      attributes:
        template: string
        length: 512